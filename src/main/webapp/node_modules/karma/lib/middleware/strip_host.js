/**
 * Strip host middleware is responsible for stripping hostname from request path
 * This to handle requests that uses (normally over proxies) an absoluteURI as request path
 */

var createStripHostMiddleware = function () {
  return function (request, response, next) {
    function stripHostFromUrl (url) {
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
      return url.replace(/^http[s]?:\/\/([a-z\-\.:\d]+)\//, '/')
=======
      return url.replace(/^http[s]?:\/\/([a-z\-.:\d]+)\//, '/')
>>>>>>> b52cc917bd6158e211e6fd5ad8ad68cceba8ac8e
=======
      return url.replace(/^http[s]?:\/\/([a-z\-.:\d]+)\//, '/')
>>>>>>> refs/remotes/origin/master
=======
      return url.replace(/^http[s]?:\/\/([a-z\-.:\d]+)\//, '/')
>>>>>>> b52cc917bd6158e211e6fd5ad8ad68cceba8ac8e
    }

    request.normalizedUrl = stripHostFromUrl(request.url) || request.url
    next()
  }
}

// PUBLIC API
exports.create = createStripHostMiddleware
